<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penalty Minigame - Football Management Game</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            font-family: 'Press Start 2P', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }
        
        .game-container {
            width: 800px;
            height: 600px;
            position: relative;
            background-color: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .screen-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #fff;
            text-align: center;
        }
        
        .game-canvas {
            width: 600px;
            height: 400px;
            background-color: #00ff00;
            position: relative;
            border: 2px solid #fff;
            overflow: hidden;
        }
        
        .goal {
            position: absolute;
            top: 50px;
            left: 200px;
            width: 200px;
            height: 150px;
            border: 4px solid #fff;
            border-top: none;
        }
        
        .goalkeeper {
            position: absolute;
            width: 40px;
            height: 60px;
            background-color: #fff;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .footballer {
            position: absolute;
            width: 30px;
            height: 50px;
            background-color: #fff;
            border-radius: 5px;
        }
        
        .football {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #fff;
            border-radius: 50%;
        }
        
        .scoreboard {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 14px;
        }
        
        .instructions {
            margin-top: 20px;
            text-align: center;
            font-size: 14px;
        }
        
        .button {
            background-color: #00ffff;
            color: #000;
            border: none;
            padding: 10px 20px;
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.2s;
        }
        
        .button:hover {
            background-color: #ffff00;
            transform: scale(1.05);
        }
        
        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: #ff0000;
        }
        
        .hidden {
            display: none;
        }
        
        .goal-area {
            position: absolute;
            top: 50px;
            left: 200px;
            width: 200px;
            height: 150px;
            border: 2px dashed #ff0000;
        }
        
        .power-meter {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 20px;
            background-color: #333;
            border: 2px solid #fff;
        }
        
        .power-fill {
            height: 100%;
            background-color: #00ff00;
            width: 0%;
            transition: width 0.1s;
        }
        
        .direction-indicator {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 20px;
            background-color: #333;
            border: 2px solid #fff;
        }
        
        .direction-fill {
            height: 100%;
            background-color: #00ffff;
            width: 50%;
            transition: width 0.1s;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <button class="button back-button" onclick="goBack()">Back</button>
        
        <h1 class="screen-title">PENALTY MINIGAME</h1>
        
        <div class="game-canvas" id="gameCanvas">
            <div class="scoreboard">
                <div>SCORE: <span id="score">0</span></div>
                <div>ATTEMPTS: <span id="attempts">0</span></div>
            </div>
            
            <div class="goal"></div>
            <div class="goalkeeper" id="goalkeeper"></div>
            <div class="footballer" id="footballer"></div>
            <div class="football" id="football"></div>
            
            <div class="power-meter hidden" id="powerMeter">
                <div class="power-fill" id="powerFill"></div>
            </div>
            
            <div class="direction-indicator hidden" id="directionIndicator">
                <div class="direction-fill" id="directionFill"></div>
            </div>
        </div>
        
        <div class="instructions" id="instructions">
            Click to start the penalty kick!
        </div>
        
        <div style="display: flex; gap: 20px; margin-top: 20px;">
            <button class="button" id="startButton" onclick="startGame()">Start Game</button>
            <button class="button" id="resetButton" onclick="resetGame()">Reset</button>
        </div>
    </div>

    <script>
        class PenaltyMinigame {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.goalkeeper = document.getElementById('goalkeeper');
                this.footballer = document.getElementById('footballer');
                this.football = document.getElementById('football');
                this.powerMeter = document.getElementById('powerMeter');
                this.powerFill = document.getElementById('powerFill');
                this.directionIndicator = document.getElementById('directionIndicator');
                this.directionFill = document.getElementById('directionFill');
                this.instructions = document.getElementById('instructions');
                this.scoreElement = document.getElementById('score');
                this.attemptsElement = document.getElementById('attempts');
                
                this.score = 0;
                this.attempts = 0;
                this.gameActive = false;
                this.power = 0;
                this.direction = 50;
                this.powerIncreasing = true;
                this.directionMoving = true;
                
                this.init();
            }
            
            init() {
                this.setupPositions();
                this.setupEventListeners();
            }
            
            setupPositions() {
                // Set initial positions
                this.footballer.style.left = '50px';
                this.footballer.style.bottom = '50px';
                this.football.style.left = '65px';
                this.football.style.bottom = '60px';
                this.goalkeeper.style.left = '280px';
                this.goalkeeper.style.top = '100px';
            }
            
            setupEventListeners() {
                this.canvas.addEventListener('click', (e) => this.handleCanvasClick(e));
            }
            
            handleCanvasClick(e) {
                if (!this.gameActive) return;
                
                // Shoot the ball
                this.shootBall();
            }
            
            startGame() {
                this.gameActive = true;
                this.instructions.textContent = 'Click to shoot!';
                this.powerMeter.classList.remove('hidden');
                this.directionIndicator.classList.remove('hidden');
                this.startPowerMeter();
                this.startDirectionIndicator();
            }
            
            startPowerMeter() {
                const powerInterval = setInterval(() => {
                    if (!this.gameActive) {
                        clearInterval(powerInterval);
                        return;
                    }
                    
                    if (this.powerIncreasing) {
                        this.power += 2;
                        if (this.power >= 100) {
                            this.power = 100;
                            this.powerIncreasing = false;
                        }
                    } else {
                        this.power -= 2;
                        if (this.power <= 0) {
                            this.power = 0;
                            this.powerIncreasing = true;
                        }
                    }
                    
                    this.powerFill.style.width = `${this.power}%`;
                }, 20);
            }
            
            startDirectionIndicator() {
                const directionInterval = setInterval(() => {
                    if (!this.gameActive) {
                        clearInterval(directionInterval);
                        return;
                    }
                    
                    if (this.directionMoving) {
                        this.direction += 1;
                        if (this.direction >= 100) {
                            this.direction = 100;
                            this.directionMoving = false;
                        }
                    } else {
                        this.direction -= 1;
                        if (this.direction <= 0) {
                            this.direction = 0;
                            this.directionMoving = true;
                        }
                    }
                    
                    this.directionFill.style.width = `${this.direction}%`;
                }, 30);
            }
            
            shootBall() {
                this.gameActive = false;
                this.powerMeter.classList.add('hidden');
                this.directionIndicator.classList.add('hidden');
                
                // Calculate shot parameters
                const power = this.power / 100;
                const direction = this.direction / 100;
                
                // Animate the ball
                this.animateShot(power, direction);
            }
            
            animateShot(power, direction) {
                const ball = this.football;
                const startX = 65;
                const startY = 60;
                const endX = 280 + (direction - 0.5) * 100; // Target position
                const endY = 120;
                
                ball.style.transition = 'all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                ball.style.left = `${endX}px`;
                ball.style.bottom = `${endY}px`;
                
                // Check if goal
                setTimeout(() => {
                    this.checkGoal(power, direction);
                }, 1000);
            }
            
            checkGoal(power, direction) {
                // Simple goal detection logic
                const keeperPosition = parseInt(this.goalkeeper.style.left);
                const ballPosition = parseInt(this.football.style.left);
                const keeperRange = 40;
                
                const scored = Math.abs(ballPosition - keeperPosition) > keeperRange && power > 30;
                
                if (scored) {
                    this.score++;
                    this.instructions.textContent = 'GOAL! ðŸŽ‰';
                } else {
                    this.instructions.textContent = 'SAVED! âŒ';
                }
                
                this.scoreElement.textContent = this.score;
                this.attempts++;
                this.attemptsElement.textContent = this.attempts;
                
                // Reset for next shot
                setTimeout(() => {
                    this.resetShot();
                }, 2000);
            }
            
            resetShot() {
                this.football.style.transition = 'none';
                this.football.style.left = '65px';
                this.football.style.bottom = '60px';
                
                this.power = 0;
                this.direction = 50;
                this.powerIncreasing = true;
                this.directionMoving = true;
                
                this.powerFill.style.width = '0%';
                this.directionFill.style.width = '50%';
                
                this.instructions.textContent = 'Click to shoot!';
                this.gameActive = true;
                this.startPowerMeter();
                this.startDirectionIndicator();
            }
            
            resetGame() {
                this.score = 0;
                this.attempts = 0;
                this.scoreElement.textContent = '0';
                this.attemptsElement.textContent = '0';
                this.instructions.textContent = 'Click Start to begin!';
                
                this.football.style.transition = 'none';
                this.football.style.left = '65px';
                this.football.style.bottom = '60px';
                
                this.power = 0;
                this.direction = 50;
                this.powerFill.style.width = '0%';
                this.directionFill.style.width = '50%';
                
                this.powerMeter.classList.add('hidden');
                this.directionIndicator.classList.add('hidden');
                this.gameActive = false;
            }
        }
        
        function goBack() {
            window.location.href = 'goal_cards.html';
        }
        
        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new PenaltyMinigame();
        });
    </script>
</body>
</html>